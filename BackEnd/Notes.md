# Backend Dev with Go

## DB migrations

Use the library golang-migrate

Install on MacOs ```brew install golang-migrate```

> Check version of migrate 

>> migrate -version

> See the migrate doc

>> migrate -help

> Create migration file with sql extention

>> migrate create -ext sql -dir db/migration/ -seq init_schema

Use a Makefile to define sh commands and make it easier

> exec a shell instruction from a file

>> make migrateup

SQLC is the fastes and easy to use library for working with dbs on Go, automatic code generation, 
catch SQL query errors before generating codes, it only supports Postgres, we have alternatives like 
SQLX, GORM and Pure DB SQL (manual mapping and errors cant be caught until runtime)

> install SQLC

>> brew install sqlc

> check sqlc version

>> sqlc version

> init a sqlc file

>> sqlc init

To create a sqlc query you will need a go module

>>  go mod init nombreModulo

After that you can specify this module when needed

> check for external libraries dependencies

>> go mod tidy

## CRUD Operations using SQLC


We can use sqlc to just define generic SQL queries like Create, Read, Update and detelete, specify
a doc like excepted and return of the operation, after that using *sqlc generate* it gives us an .sql.go, 
db.go and models.go autogenerated files.

``` 
-- name: UpdateAccount :exec
UPDATE accounts
  set balance = $2
WHERE id = $1;
```